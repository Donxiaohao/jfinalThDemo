<!DOCTYPE html>
<html lang="zh-CN">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>登陆丨OAM</title>
<link rel="stylesheet" href="/css/style.css">
<style>

</style>

<body>
<div id="content">
	<canvas width="800" height="500" id="canvas" style=" background-color:#EEEEEE; border:1px solid #444;">
</div>
<div onclick='removeSence();'>removeSence</div>
</body>
<script src="http://www.jq22.com/jquery/1.11.1/jquery.min.js"></script>
<script src="/js/jtopo-0.4.8-min.js"></script>
<script src="/js/toolbar.js"></script>
<script>
var canvas = document.getElementById('canvas'); 
var stage = new JTopo.Stage(canvas); // 创建一个舞台对象
var scene = new JTopo.Scene(stage); // 创建一个场景对象
	 $(function (){
		 CanvasRenderingContext2D.prototype.wrapText = function(str,x,y){
			 var textArray = str.split('\n');
			 if(textArray==undefined||textArray==null)return false;
			 var rowCnt = textArray.length;
			 var i = 0,imax = rowCnt,maxLength = 0;maxText = textArray[0];
			 for(;i<imax;i++){
				 var nowText = textArray[i],textLength = nowText.length;
				 if(textLength >=maxLength){
					 maxLength = textLength;
					 maxText = nowText;
				 }
			 }
			 var maxWidth = this.measureText(maxText).width;
			 var lineHeight = this.measureText("元").width;
			 x-= lineHeight*2;
			 for(var j= 0;j<textArray.length;j++){
				 var words = textArray[j];
				 this.fillText(words,-(maxWidth/2),y-textArray.length*lineHeight/100);
				 y+= lineHeight;
			 }
		 };

		 
		
		stage.frames = -24;
	
        // 节点
        function newNode(x, y, w, h, text){
            var node = new JTopo.Node(text);
            node.setLocation(x, y);
            node.setSize(w, h);
            scene.add(node);
            return node;
        }
        
        // 简单连线
        function newLink(nodeA, nodeZ, text,dashedPattern){
            var link = new JTopo.Link(nodeA, nodeZ, text);        
            link.lineWidth = 3; // 线宽
            link.bundleOffset = 60; // 折线拐角处的长度
            link.bundleGap = 20; // 线条之间的间隔
            link.textOffsetY = 3; // 文本偏移量（向下3个像素）
            link.strokeColor = JTopo.util.randomColor(); // 线条颜色随机
            link.dashedPattern = dashedPattern; 
            link.addEventListener("click",function(link){
		    	console.log(link);
		    })
            scene.add(link);
            return link;
        }
       
        var node = new JTopo.Node(260,190,30,30,'test\ntest'); // 创建一个节点
        node.paintText = function(a){
	        a.beginPath(),
	        a.font = this.font,
	        a.wrapText(this.text,this.height/2,this.height);
	        a.closePath()
        };
       
	}) 
</script>
</html>