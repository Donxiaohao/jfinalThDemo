<!DOCTYPE html>
<html lang="zh-CN">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>登陆丨OAM</title>
<link rel="stylesheet" href="/css/style.css">
<style>
#contextmenu {
		border: 1px solid #aaa;
		border-bottom: 0;
		background: #eee;
		position: absolute;
		list-style: none;
		margin: 0;
		padding: 0;
		display: none;
	}
																			   
	#contextmenu li a {
		display: block;
		padding: 10px;
		border-bottom: 1px solid #aaa;
		cursor: pointer;
	}
																			   
	#contextmenu li a:hover {
		background: #fff;
	}
</style>

<body>
<ul id="contextmenu" style="display:none;">    
            <li><a>顺时针旋转</a></li>
            <li><a>逆时针旋转</a></li>    
            <li><a>更改颜色</a></li>
            <li><a>放大</a></li>
            <li><a>缩小</a></li>    
            <li><a>删除该节点</a></li>
            <li><a>添加节点信息</a></li>
            </ul>
<div id="content" style='width:"auto" height:"auto"'>
	<canvas width="1200px" height="500px" id="canvas" style=" background-color:#EEEEEE; border:1px solid #444;">
</div>
<div onclick='removeSence();'>removeSence</div>
</body>
<script src="http://www.jq22.com/jquery/1.11.1/jquery.min.js"></script>
<script src="/js/jtopo-0.4.8-min.js"></script>
<script src="/js/toolbar.js"></script>
<script>
/* var canvas = document.getElementById('canvas'); 
var stage = new JTopo.Stage(canvas); // 创建一个舞台对象
var scene = new JTopo.Scene(stage); // 创建一个场景对象
	$(function (){	
	    // 节点
	     function newNode(x, y, w, h, text){
	        var node = new JTopo.Node(text);
	        node.setLocation(x, y);
	        node.setSize(w, h);
	        node.fillColor='255,128,0';
	        node.fontColor='rgba(0, 0, 0,1 )';
	        scene.add(node);
	        return node;
	    }
	 
	    // 简单连线
	        function newLink(nodeA, nodeZ, text, dashedPattern,arrowsRadius){
	        var link = new JTopo.Link(nodeA, nodeZ, text);
	        link.lineWidth = 2; // 线宽
	        link.dashedPattern = dashedPattern; // 虚线
	        link.bundleOffset = 60; // 折线拐角处的长度
	        link.bundleGap = 20; // 线条之间的间隔
	        link.textOffsetY = 3; // 文本偏移量（向下3个像素）
	        link.strokeColor = '0,250,0';
	        link.fontColor='0,0,0';
	        if(arrowsRadius){
	        	link.arrowsRadius = 10;
	        }  
	        scene.add(link);
	        return link;
	    }
	 
	    // 折线
        function newFoldLink(nodeA, nodeZ, text, direction, dashedPattern){
               var link = new JTopo.FoldLink(nodeA, nodeZ, text);
               link.direction = direction || 'horizontal';
               link.arrowsRadius = 15; //箭头大小
               link.lineWidth = 3; // 线宽
               link.bundleOffset = 60; // 折线拐角处的长度
               link.bundleGap = 10; // 线条之间的间隔
               link.textOffsetY = 3; // 文本偏移量（向下3个像素）
               link.fontColor='rgba(255,0,0,1)';
               link.strokeColor = '0,250,0';
			   link.fontColor
               link.dashedPattern = dashedPattern; 
               
               scene.add(link);
               return link;
        }
 
	    // 二次折线
	    function newFlexionalLink(nodeA, nodeZ, text, direction, dashedPattern){
	        var link = new JTopo.FlexionalLink(nodeA, nodeZ, text);
	        link.direction = direction || 'horizontal';
	        link.arrowsRadius = 10;
	        link.lineWidth = 3; // 线宽
	        link.offsetGap = 47;
	        link.bundleGap = 20; // 线条之间的间隔
	        link.textOffsetY = 10; // 文本偏移量（向下15个像素）
	        link.strokeColor = '0,250,0';
	        link.dashedPattern = dashedPattern;
	        scene.add(link);
	        return link;
	    }
	 
	    // 曲线
	    function newCurveLink(nodeA, nodeZ, text){
	        var link = new JTopo.CurveLink(nodeA, nodeZ, text);
	        link.lineWidth = 3; // 线宽
	        scene.add(link);
	        return link;
	    }
 

	    #for(node:topoNodeInfos)
	    	var node#(node.id) = newNode(#(node.x),#(node.y),#(node.width),#(node.height),'#(node.text)');
	    #end
	    
//	    newLink(node1,node30,'test');
	 /*    var link1=newFoldLink(node1,node30,null,'horizontal');
	    var link2=newFlexionalLink(node2,node30,null,'horizontal');
	    link2.offsetGap=70;
	    var link3=newFlexionalLink(node3,node30,null,'horizontal');
	    link3.offsetGap=90; */
	     
	    /* #for(line:topoLineInfos)
	    	var link#(line.id)=newLink(node#(line.src),node#(line.dest),'#(line.text)');
	    #end */
	/*    newFlexionalLink(node4,node31);
	    newFlexionalLink(node5,node31);
	    newFlexionalLink(node6,node31);
	    newFlexionalLink(node7,node31);
	    newFlexionalLink(node8,node31);
	    
         stage.add(scene);
         
         //居中显示
         scene.centerAndZoom();
	}) */
	
	  $(document).ready(function(){                    
          var canvas = document.getElementById('canvas');
          var stage = new JTopo.Stage(canvas);
         
          var scene = new JTopo.Scene();
          stage.add(scene);
          
          
          function handler(event){
              if(event.button == 2){// 右键
                  // 当前位置弹出菜单（div）
                  $("#contextmenu").css({
                      top: event.pageY,
                      left: event.pageX
                  }).show();    
              }
          }
          
          
          var cloudNode = new JTopo.Node('root');
          cloudNode.setSize(30, 26);
          cloudNode.setLocation(360,130);            
          cloudNode.layout = {type: 'tree', width:300, height: 100}
          
          scene.add(cloudNode);
          
          for(var k=1; k<4; k++){
              var node = new JTopo.Node('host' + k);
              node.fillStyle = '200,255,0';
              node.radius = 15;
              node.setLocation(scene.width * Math.random(), scene.height * Math.random());
              node.layout = {type: 'tree', width:100, height: 100};
              
              scene.add(node);                                
              var link = new JTopo.Link(cloudNode, node);
              scene.add(link);
              
              /* for(var j=0; j<4; j++){
                  var vmNode = new JTopo.CircleNode('vm-' + i + '-' + j);
                  vmNode.radius = 10;
                  vmNode.fillStyle = '255,255,0';
                  vmNode.setLocation(scene.width * Math.random(), scene.height * Math.random());
                  scene.add(vmNode);                                
                  scene.add(new JTopo.Link(node, vmNode));      
              } */
               for(var i=1; i<3; i++){
                  var node2 = new JTopo.Node('server' + i);
                  node2.fillStyle = '200,255,0';
                  node2.radius = 15;
                  node2.setLocation(scene.width * Math.random(), scene.height * Math.random());
                  node2.layout = {type: 'tree', width:50, height: 100};
                  
                  scene.add(node2);                                
                  var link = new JTopo.Link(node, node2);
                  scene.add(link);
                  
                  for(var j=0; j<2; j++){
                      var vmNode = new JTopo.CircleNode('client-' + i + '-' + j);
                      vmNode.radius = 10;
                      vmNode.fillStyle = '255,255,0';
                      vmNode.setLocation(scene.width * Math.random(), scene.height * Math.random());
                      scene.add(vmNode);                                
                      scene.add(new JTopo.Link(node2, vmNode));      
                  }
              }
          }
          
          
          
          JTopo.layout.layoutNode(scene, cloudNode, true);
          
          scene.addEventListener('mouseup', function(e){
              if(e.target && e.target.layout){
                  JTopo.layout.layoutNode(scene, e.target, true);    
              }                
          });
          
          stage.centerAndZoom();
      });                    
  
</script>
</html>